<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" type="image/x-icon" href="/logo.ico">
    <title>Wordcloud</title>
    <link rel="stylesheet" href="/style.css">
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.1.2/src/wordcloud2.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        main.card {
            width: 100%;
            margin: 20px auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-weight: 700;
            color: #1a73e8;
        }

        .controls {
            margin-bottom: 20px;
            justify-content: center !important;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            margin: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: 0.2s;
        }

        button:hover {
            background: #45a049;
        }

        button:disabled {
            background: #aaa;
            cursor: not-allowed;
        }

        #qrcode {
            margin: 20px auto;
            width: 240px;
            height: 240px;
        }

        #cloud {
            width: 100%;
            height: 100%;
            margin: 20px auto;
            display: block;
            border: 1px solid #ddd;
            border-radius: 8px;
        }

        #newQuestionBtn {
            display: none;
        }

        #currentQuestion {
            font-weight: bold;
            margin: 15px 0;
        }

        .help-icon {
            float: right;
            display: inline-block;
            margin-left: 8px;
            color: #1a73e8;
            cursor: pointer;
            font-weight: bold;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            line-height: 24px;
            text-align: center;
            background: #e0f0ff;
            transition: background 0.2s;
        }

        .help-icon:hover {
            background: #cce0ff;
        }

        .tooltip {
            display: none;
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: #1a73e8;
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            max-width: 400px;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            line-height: 1.4;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 8px;
            border-style: solid;
            border-color: transparent transparent #1a73e8 transparent;
        }
    </style>
</head>

<body>
    <main class="card">
        <div style="text-align: center;">
            <img src="/logo.png" alt="Logo" style="width: 50%; max-width: 100%; height: auto; max-width: 300px;">
            <span class="help-icon" id="helpIcon">?</span>
        </div>
        <div class="tooltip" id="tooltip">
            Nueva nube para crear un nuevo QR y conectar usuarios asociados a una pregunta o enunciado.
            Una vez conectados los usuarios, no debe refrescar m치s. Puedes ir a침adiendo nuevas preguntas sin necesidad
            de crear nuevas nubes.
            El usuario solo puede a침adir una palabra por cada pregunta, con m치ximo un espacio y longitud de 50
            caracteres.
        </div>
        <div class="controls">
            <button id="createBtn">Crear nube</button>
            <div id="sessionBox" class="hidden">
                <p style="display: none">Session ID: <strong id="sessionId"></strong></p>
                <div id="qrcode"></div>
            </div>
            <button id="newQuestionBtn">Nueva pregunta</button>
        </div>
        <p>URL: <a id="sessionUrl"></a></p>
        <h1 style="font-weight: bold;">Pregunta actual: <span id="question">N/A</span></h1>
        <p>Participantes: <span id="count">0</span> | Palabras enviadas: <span id="wordCount">0</span></p>

        <canvas id="cloud"></canvas>
        <footer
            style="text-align: center; padding: 15px 0; font-family: 'Roboto', sans-serif; font-size: 0.9rem; color: #666;">
            Creado por <a href="https://www.linkedin.com/in/carlosserranosanchez/" target="_blank"
                style="color: #1a73e8; text-decoration: none; transition: color 0.3s;">
                Carlos Serrano
            </a>
        </footer>
    </main>
    <script>
        const helpIcon = document.getElementById('helpIcon');
        const tooltip = document.getElementById('tooltip');

        helpIcon.addEventListener('click', () => {
            if (tooltip.style.display === 'block') {
                tooltip.style.display = 'none';
            } else {
                tooltip.style.display = 'block';
            }
        });

        // Cerrar tooltip al hacer clic fuera
        document.addEventListener('click', (e) => {
            if (!helpIcon.contains(e.target) && !tooltip.contains(e.target)) {
                tooltip.style.display = 'none';
            }
        });
    </script>

    <script>
        window.APP_ROLE = 'organizer';
    </script>
    <script src="/app.js"></script>
</body>

</html>